# Сборка и запуск

Все инструкции приведены для *nix-подобных систем. 

Для ОС Windows инструкция примерно аналогична. 
Мы рекомендуем запускать бота в контейнере.

## С использованием Docker

Для запуска проекта в контейнере необходимо:

1. Создать файл конфигурации, скопировав наш шаблон: 
`$ cp cmd/trade-bot/.env-example cmd/trade-bot/.env`

2. Выставить базовые настройки (см. раздел "Конфигурация") 
любым удобным редактором, например, через vim: `$ vim cmd/trade-bot/.env`

3. Запустить проект с использованием docker-compose: `$ docker-compose up --build`

## Из исходного кода

Для запуска проекта требуется компилятор Go версии 1.16 и выше:

1. Создать файл конфигурации, скопировав наш шаблон: 
`$ cp cmd/trade-bot/.env-example cmd/trade-bot/.env`

2. Выставить базовые настройки (см. раздел "Конфигурация") 
любым удобным редактором, например, через vim: `$ vim cmd/trade-bot/.env`

3. Экспортировать переменные окружения из конфига командой 
`$ export $(grep -v '^#' cmd/trade-bot/.env | xargs)`

4. Собрать бинарный файл: 
`$ go build -v -o trade-bot ./cmd/trade-bot`

5. Запустить торгового бота: `$ ./trade-bot`

Инструкция по запуску trade-utils (см. раздел "Дополнительно")
идентична в точности до имени исполняемого файла.

P.S. Данный воркфлоу можно значительно упростить с использованием IDE Goland.

## Для разработчиков 

В файле [docker-compose.dev.yml](https://github.com/elkopass/BITA/blob/main/docker-compose.dev.yml)
добавлены контейнеры с Prometheus и Grafana, на которых построен мониторинг
торгового процесс (см. раздел "Визуализация").

Чтобы их запустить, требуется:

1. Создать в корневой директории `prometheus.yml`, добавив в targets внутренний
адрес торгового бота (по типу `"trade_bot_1:8080"`)

2. Запустить сервисы командой `$ docker-compose -f docker-compose.dev.yml up --build -d`

3. Зайти на http://localhost:3000 и настроить Grafana с импортированным 
[дашбордом](https://github.com/elkopass/BITA/blob/main/.grafana/TradeBot.json) и
Prometheus в качестве Data Source
